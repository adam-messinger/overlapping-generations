<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Economic Trajectory Model</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #111827;
      color: #fff;
      min-height: 100vh;
      padding: 24px;
    }
    .container { max-width: 900px; margin: 0 auto; }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }
    h1 { color: #F59E0B; font-size: 1.5rem; font-weight: 600; }
    .reset-btn {
      padding: 8px 16px;
      background: #374151;
      border: none;
      border-radius: 6px;
      color: #D1D5DB;
      cursor: pointer;
      font-size: 0.875rem;
    }
    .reset-btn:hover { background: #4B5563; }

    /* Main Chart */
    .chart-section {
      background: rgba(31, 41, 55, 0.5);
      border: 1px solid #374151;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
    }
    .chart-title {
      font-size: 1rem;
      color: #9CA3AF;
      margin-bottom: 16px;
    }
    .chart-container {
      height: 320px;
      position: relative;
    }

    /* Metrics Row */
    .metrics-row {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 32px;
    }
    @media (max-width: 600px) {
      .metrics-row { grid-template-columns: repeat(2, 1fr); }
    }
    .metric-card {
      background: rgba(31, 41, 55, 0.5);
      border: 1px solid #374151;
      border-radius: 12px;
      padding: 16px;
      text-align: center;
    }
    .metric-value {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .metric-value.positive { color: #10B981; }
    .metric-value.negative { color: #EF4444; }
    .metric-value.neutral { color: #F59E0B; }
    .metric-label {
      font-size: 0.75rem;
      color: #6B7280;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Controls Section */
    .controls-section {
      border-top: 1px solid #374151;
      padding-top: 32px;
    }
    .controls-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 32px;
    }
    @media (max-width: 700px) {
      .controls-grid { grid-template-columns: 1fr; gap: 24px; }
    }

    .control-group {
      text-align: center;
    }
    .control-title {
      font-size: 0.875rem;
      font-weight: 600;
      color: #F59E0B;
      margin-bottom: 16px;
    }

    /* Immigration Slider */
    .slider-container {
      padding: 0 8px;
    }
    .slider-value-display {
      font-size: 2rem;
      font-weight: 700;
      color: #fff;
      margin-bottom: 8px;
    }
    .slider-reference {
      font-size: 0.75rem;
      color: #6B7280;
      margin-bottom: 12px;
    }
    input[type="range"] {
      width: 100%;
      height: 8px;
      background: #374151;
      border-radius: 4px;
      appearance: none;
      cursor: pointer;
    }
    input[type="range"]::-webkit-slider-thumb {
      appearance: none;
      width: 24px;
      height: 24px;
      background: #F59E0B;
      border-radius: 50%;
      cursor: grab;
    }
    input[type="range"]::-webkit-slider-thumb:active {
      cursor: grabbing;
    }
    .slider-labels {
      display: flex;
      justify-content: space-between;
      font-size: 0.75rem;
      color: #6B7280;
      margin-top: 8px;
    }

    /* Button Groups */
    .button-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .option-btn {
      padding: 12px 16px;
      background: #374151;
      border: 2px solid #374151;
      border-radius: 8px;
      color: #9CA3AF;
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 500;
      text-align: left;
      transition: all 0.15s ease;
    }
    .option-btn:hover {
      background: #4B5563;
      border-color: #4B5563;
    }
    .option-btn.active {
      background: rgba(245, 158, 11, 0.15);
      border-color: #F59E0B;
      color: #F59E0B;
    }
    .option-btn .desc {
      font-size: 0.75rem;
      color: #6B7280;
      font-weight: 400;
      margin-top: 2px;
    }
    .option-btn.active .desc {
      color: #D97706;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Economic Trajectory: 2025-2075</h1>
      <button class="reset-btn" onclick="resetToDefaults()">Reset</button>
    </header>

    <div class="chart-section">
      <div class="chart-title">Output per Capita</div>
      <div class="chart-container">
        <canvas id="mainChart"></canvas>
      </div>
    </div>

    <div class="metrics-row" id="metrics"></div>

    <div class="controls-section">
      <div class="controls-grid">
        <!-- Immigration Control -->
        <div class="control-group">
          <div class="control-title">Immigration</div>
          <div class="slider-container">
            <div class="slider-value-display" id="immigration-display">0.5%</div>
            <div class="slider-reference">Current US: ~0.3%</div>
            <input type="range" id="immigration-slider" min="0" max="2" step="0.1" value="0.5"
                   oninput="updateImmigration(this.value)">
            <div class="slider-labels">
              <span>0%</span>
              <span>1%</span>
              <span>2%</span>
            </div>
          </div>
        </div>

        <!-- Productivity Control -->
        <div class="control-group">
          <div class="control-title">Productivity</div>
          <div class="button-group">
            <button class="option-btn" onclick="setProductivity('stagnation')" data-productivity="stagnation">
              Stagnation
              <div class="desc">TFP growth: 0.5%</div>
            </button>
            <button class="option-btn active" onclick="setProductivity('baseline')" data-productivity="baseline">
              Baseline
              <div class="desc">TFP growth: 1.0%</div>
            </button>
            <button class="option-btn" onclick="setProductivity('ai-boom')" data-productivity="ai-boom">
              AI Boom
              <div class="desc">TFP growth: 2.0% + automation</div>
            </button>
          </div>
        </div>

        <!-- Politics Control -->
        <div class="control-group">
          <div class="control-title">Political Flexibility</div>
          <div class="button-group">
            <button class="option-btn" onclick="setPolitics('locked')" data-politics="locked">
              Locked
              <div class="desc">No reform possible</div>
            </button>
            <button class="option-btn active" onclick="setPolitics('moderate')" data-politics="moderate">
              Moderate
              <div class="desc">Reform at 55% young bloc</div>
            </button>
            <button class="option-btn" onclick="setPolitics('responsive')" data-politics="responsive">
              Responsive
              <div class="desc">Reform at 45% young bloc</div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
// ============================================
// EXTENDED OLG MODEL - Simplified UI
// ============================================

const DEFAULT_PARAMS = {
  // Core OLG
  alpha: 0.33,
  tfp: 1.0,
  delta: 0.05,
  beta: 0.96,
  gamma: 2.0,

  // Demographics
  birthRate: 0.012,
  agingRate: 0.05,
  deathRate: 0.05,

  // Initial state
  initialCapital: 3.0,
  initialPopYoung: 1.0,
  initialPopMiddle: 0.9,
  initialPopOld: 0.6,

  // Government
  taxRate: 0.22,
  govSpendingRate: 0.18,
  ssReplacementRate: 0.40,
  initialDebtRatio: 1.22,

  // Politics
  turnoutYoung: 0.47,
  turnoutMiddle: 0.63,
  turnoutOld: 0.75,
  oldPolicyWeight: 0.6,
  reformThreshold: 0.55,

  // Monetary
  inflationTarget: 0.02,
  fedReactivity: 0.5,
  fedDebtConstraint: 0.3,
  nominalRigidity: 0.5,

  // Immigration
  immigrationRate: 0.005,
  immigrantAge: 'young',
  immigrantWealth: 0.2,

  // Inequality
  initialGini: 0.41,
  topShareIncome: 0.20,
  topShareWealth: 0.70,
  wealthMobility: 0.02,

  // Productivity
  tfpGrowth: 0.01,
  aiShockYear: 0,
  aiShockSize: 0.0,
  aiLaborDisplacement: 0.0,

  // Simulation
  yearsToSimulate: 50,
};

let params = { ...DEFAULT_PARAMS };
let baselineData = [];
let scenarioData = [];
let chart = null;

// UI state
let currentProductivity = 'baseline';
let currentPolitics = 'moderate';

// ============================================
// SIMULATION ENGINE
// ============================================
function runSimulation(p) {
  const history = [];

  let K = p.initialCapital;
  let popYoung = p.initialPopYoung;
  let popMiddle = p.initialPopMiddle;
  let popOld = p.initialPopOld;
  let debt = p.initialDebtRatio * p.initialCapital;
  let tfp = p.tfp;

  let wealthYoungTop = 0.4, wealthYoungBot = 0.1;
  let wealthMiddleTop = 1.6, wealthMiddleBot = 0.4;
  let wealthOldTop = 2.4, wealthOldBot = 0.6;

  let inflation = p.inflationTarget;
  let nominalRate = 0.04;
  let realWageIndex = 1.0;

  let effectiveTaxRate = p.taxRate;
  let effectiveSSRate = p.ssReplacementRate;

  for (let t = 0; t < p.yearsToSimulate; t++) {
    const year = 2025 + t;

    // Productivity shocks
    let currentTfp = tfp;
    let laborDemandShock = 1.0;
    if (p.aiShockYear > 0 && t >= p.aiShockYear) {
      const yearsAfterShock = t - p.aiShockYear;
      const aiBoost = p.aiShockSize * (1 - Math.exp(-yearsAfterShock / 5));
      currentTfp = tfp * (1 + aiBoost);
      laborDemandShock = 1 - p.aiLaborDisplacement * (1 - Math.exp(-yearsAfterShock / 10));
    }

    // Demographics + Immigration
    const births = (popYoung + popMiddle) * p.birthRate;
    const newMiddle = popYoung * p.agingRate;
    const newOld = popMiddle * p.agingRate;
    const deaths = popOld * p.deathRate;

    const totalPop = popYoung + popMiddle + popOld;
    const immigrants = totalPop * p.immigrationRate;
    let immigrantsYoung = 0, immigrantsMiddle = 0;
    if (p.immigrantAge === 'young') {
      immigrantsYoung = immigrants;
    } else {
      immigrantsYoung = immigrants * 0.6;
      immigrantsMiddle = immigrants * 0.4;
    }

    // Labor supply
    const laborYoung = popYoung * 0.7 * laborDemandShock;
    const laborMiddle = popMiddle * 1.0 * laborDemandShock;
    const L = laborYoung + laborMiddle;

    // Production
    const Y = currentTfp * Math.pow(K, p.alpha) * Math.pow(L, 1 - p.alpha);
    const yPerCapita = Y / totalPop;

    // Factor prices
    const wage = (1 - p.alpha) * Y / L;
    const r_gross = p.alpha * Y / K;
    const realRate = r_gross - p.delta;

    // Politics: voting power
    const votesYoung = popYoung * p.turnoutYoung;
    const votesMiddle = popMiddle * p.turnoutMiddle;
    const votesOld = popOld * p.turnoutOld;
    const totalVotes = votesYoung + votesMiddle + votesOld;

    const middleOldLean = 0.4 + (t * 0.005);
    const oldBloc = votesOld + votesMiddle * Math.min(0.7, middleOldLean);
    const youngBloc = votesYoung + votesMiddle * (1 - Math.min(0.7, middleOldLean));
    const oldBlocShare = oldBloc / totalVotes;
    const youngBlocShare = youngBloc / totalVotes;

    const reformPossible = youngBlocShare > p.reformThreshold;
    const policyResistance = oldBlocShare * p.oldPolicyWeight;

    if (reformPossible && debt / Y > 1.5) {
      effectiveSSRate = Math.max(0.25, effectiveSSRate - 0.005);
      effectiveTaxRate = Math.min(0.35, effectiveTaxRate + 0.002);
    } else {
      effectiveSSRate = effectiveSSRate * (1 - 0.001 * (1 - policyResistance)) + p.ssReplacementRate * 0.001;
    }

    // Government
    const taxRevenue = effectiveTaxRate * wage * L;
    const govSpending = p.govSpendingRate * Y;
    const ssPayments = effectiveSSRate * wage * popOld;
    const interestPayment = Math.max(0, nominalRate - inflation) * debt;
    const primaryDeficit = govSpending + ssPayments - taxRevenue;
    const totalDeficit = primaryDeficit + interestPayment;
    debt = Math.max(0, debt + totalDeficit);
    const debtToGdp = debt / Y;

    // Monetary policy
    const deficitPressure = Math.max(0, totalDeficit / Y) * 0.3;
    const demandPressure = Math.max(0, (realRate - 0.02)) * 0.2;
    const targetInflation = p.inflationTarget + deficitPressure - demandPressure;
    inflation = inflation * 0.8 + targetInflation * 0.2;

    const desiredRate = p.inflationTarget + realRate + p.fedReactivity * (inflation - p.inflationTarget);
    const debtConstraint = Math.max(0, (debtToGdp - 1.0) * p.fedDebtConstraint);
    const constrainedRate = desiredRate * (1 - debtConstraint);
    nominalRate = Math.max(0.001, Math.min(0.15, nominalRate * 0.9 + constrainedRate * 0.1));

    const targetRealWage = wage;
    realWageIndex = realWageIndex * p.nominalRigidity + targetRealWage * (1 - p.nominalRigidity);

    // Household optimization
    const wageAfterTax = realWageIndex * (1 - effectiveTaxRate);
    const betaAdj = Math.pow(p.beta, 1/p.gamma);
    const rAdj = Math.pow(Math.max(1.001, 1 + realRate), (1 - p.gamma) / p.gamma);
    const savingsRateOptimal = Math.max(0.1, Math.min(0.6, (betaAdj * rAdj) / (1 + betaAdj * rAdj)));

    const savingsRateYoung = Math.min(0.5, savingsRateOptimal * 1.3);
    const savingsRateMiddle = savingsRateOptimal * 0.9;

    // Income & consumption by quintile
    const topIncomeShare = p.topShareIncome;
    const botIncomeShare = 1 - topIncomeShare;

    const incomeYoungTop = wageAfterTax * 0.7 * popYoung * 0.2 * (topIncomeShare / 0.2);
    const incomeYoungBot = wageAfterTax * 0.7 * popYoung * 0.8 * (botIncomeShare / 0.8);
    const consYoungTop = incomeYoungTop * (1 - savingsRateYoung * 1.2);
    const consYoungBot = incomeYoungBot * (1 - savingsRateYoung * 0.7);
    const savingsYoungTop = incomeYoungTop - consYoungTop;
    const savingsYoungBot = incomeYoungBot - consYoungBot;

    const incomeMiddleTop = wageAfterTax * 1.0 * popMiddle * 0.2 * (topIncomeShare / 0.2);
    const incomeMiddleBot = wageAfterTax * 1.0 * popMiddle * 0.8 * (botIncomeShare / 0.8);
    const consMiddleTop = incomeMiddleTop * (1 - savingsRateMiddle * 1.2);
    const consMiddleBot = incomeMiddleBot * (1 - savingsRateMiddle * 0.7);
    const savingsMiddleTop = incomeMiddleTop - consMiddleTop;
    const savingsMiddleBot = incomeMiddleBot - consMiddleBot;

    const ssTop = ssPayments * 0.2 * 0.8;
    const ssBot = ssPayments * 0.8 * 1.05;
    const wealthIncomeTop = wealthOldTop * Math.max(0, realRate) * 0.1;
    const wealthIncomeBot = wealthOldBot * Math.max(0, realRate) * 0.1;
    const consOldTop = ssTop + wealthIncomeTop + wealthOldTop * 0.05;
    const consOldBot = ssBot + wealthIncomeBot + wealthOldBot * 0.05;

    const totalConsumption = consYoungTop + consYoungBot + consMiddleTop + consMiddleBot + consOldTop + consOldBot;
    const totalSavings = savingsYoungTop + savingsYoungBot + savingsMiddleTop + savingsMiddleBot;

    // Capital accumulation
    const investment = Math.max(0, totalSavings - totalDeficit);
    const K_next = (1 - p.delta) * K + investment;

    // Wealth dynamics
    const returnRate = 1 + realRate;

    let wYT_new = wealthYoungTop * returnRate + savingsYoungTop;
    let wYB_new = wealthYoungBot * returnRate + savingsYoungBot;
    let wMT_new = wealthMiddleTop * returnRate + savingsMiddleTop;
    let wMB_new = wealthMiddleBot * returnRate + savingsMiddleBot;
    let wOT_new = Math.max(0, wealthOldTop * returnRate * 0.95 - consOldTop * 0.3);
    let wOB_new = Math.max(0, wealthOldBot * returnRate * 0.95 - consOldBot * 0.3);

    const bequestsTop = wealthOldTop * p.deathRate;
    const bequestsBot = wealthOldBot * p.deathRate;

    const mobilityUp = p.wealthMobility;
    const mobilityDown = p.wealthMobility * 0.5;

    // Inequality metrics
    const totalWealth = wealthYoungTop + wealthYoungBot + wealthMiddleTop + wealthMiddleBot + wealthOldTop + wealthOldBot;
    const topWealth = wealthYoungTop + wealthMiddleTop + wealthOldTop;
    const topWealthShare = totalWealth > 0 ? topWealth / totalWealth : 0.7;

    // Update state
    popYoung = popYoung * (1 - p.agingRate) + births + immigrantsYoung;
    popMiddle = popMiddle * (1 - p.agingRate) + newMiddle + immigrantsMiddle;
    popOld = popOld * (1 - p.deathRate) + newOld;

    K = K_next;

    wealthYoungTop = wYT_new + bequestsTop * 0.5 - wYT_new * mobilityDown + wYB_new * mobilityUp;
    wealthYoungBot = wYB_new + bequestsBot * 0.3 + wYT_new * mobilityDown - wYB_new * mobilityUp;
    wealthMiddleTop = wMT_new + bequestsTop * 0.4 - wMT_new * mobilityDown + wMB_new * mobilityUp;
    wealthMiddleBot = wMB_new + bequestsBot * 0.5 + wMT_new * mobilityDown - wMB_new * mobilityUp;
    wealthOldTop = Math.max(0, wOT_new);
    wealthOldBot = Math.max(0, wOB_new);

    wealthYoungTop += immigrantsYoung * 0.2 * p.immigrantWealth * (topWealthShare);
    wealthYoungBot += immigrantsYoung * 0.8 * p.immigrantWealth * (1 - topWealthShare);

    tfp *= (1 + p.tfpGrowth);

    history.push({
      year,
      yPerCapita,
      debtToGdp,
      reformPossible,
      dependencyRatio: popOld / (popYoung + popMiddle),
      youngBlocShare,
    });
  }

  return history;
}

// ============================================
// UI CONTROLS
// ============================================
function updateImmigration(value) {
  params.immigrationRate = parseFloat(value) / 100;
  document.getElementById('immigration-display').textContent = value + '%';
  update();
}

function setProductivity(mode) {
  currentProductivity = mode;

  // Update button states
  document.querySelectorAll('[data-productivity]').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.productivity === mode);
  });

  // Apply preset
  if (mode === 'stagnation') {
    params.tfpGrowth = 0.005;
    params.aiShockYear = 0;
    params.aiShockSize = 0;
    params.aiLaborDisplacement = 0;
  } else if (mode === 'baseline') {
    params.tfpGrowth = 0.01;
    params.aiShockYear = 0;
    params.aiShockSize = 0;
    params.aiLaborDisplacement = 0;
  } else if (mode === 'ai-boom') {
    params.tfpGrowth = 0.02;
    params.aiShockYear = 5;
    params.aiShockSize = 0.3;
    params.aiLaborDisplacement = 0.15;
  }

  update();
}

function setPolitics(mode) {
  currentPolitics = mode;

  // Update button states
  document.querySelectorAll('[data-politics]').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.politics === mode);
  });

  // Apply preset
  if (mode === 'locked') {
    params.reformThreshold = 0.99; // Effectively impossible
    params.oldPolicyWeight = 0.9;
  } else if (mode === 'moderate') {
    params.reformThreshold = 0.55;
    params.oldPolicyWeight = 0.6;
  } else if (mode === 'responsive') {
    params.reformThreshold = 0.45;
    params.oldPolicyWeight = 0.4;
  }

  update();
}

function resetToDefaults() {
  params = { ...DEFAULT_PARAMS };
  currentProductivity = 'baseline';
  currentPolitics = 'moderate';

  document.getElementById('immigration-slider').value = 0.5;
  document.getElementById('immigration-display').textContent = '0.5%';

  document.querySelectorAll('[data-productivity]').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.productivity === 'baseline');
  });
  document.querySelectorAll('[data-politics]').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.politics === 'moderate');
  });

  update();
}

// ============================================
// RENDERING
// ============================================
function renderMetrics() {
  const start = scenarioData[0];
  const end = scenarioData[scenarioData.length - 1];
  const baselineEnd = baselineData[baselineData.length - 1];

  // Living standard change vs today
  const livingStandardChange = ((end.yPerCapita / start.yPerCapita) - 1) * 100;

  // Debt trajectory
  let debtStatus = 'Stable';
  let debtClass = 'neutral';
  if (end.debtToGdp > 2.0) {
    debtStatus = 'Exploding';
    debtClass = 'negative';
  } else if (end.debtToGdp > 1.5) {
    debtStatus = 'Rising';
    debtClass = 'negative';
  } else if (end.debtToGdp < 1.0) {
    debtStatus = 'Falling';
    debtClass = 'positive';
  }

  // Reform window
  const reformYear = scenarioData.find(d => d.reformPossible);
  const reformWindow = reformYear ? reformYear.year : 'Never';
  const reformClass = reformYear ? 'positive' : 'negative';

  // Dependency ratio (workers per retiree)
  const workersPerRetiree = (1 / end.dependencyRatio).toFixed(1);
  const depClass = end.dependencyRatio > 0.5 ? 'negative' : 'neutral';

  document.getElementById('metrics').innerHTML = `
    <div class="metric-card">
      <div class="metric-value ${livingStandardChange >= 0 ? 'positive' : 'negative'}">
        ${livingStandardChange >= 0 ? '+' : ''}${livingStandardChange.toFixed(0)}%
      </div>
      <div class="metric-label">2075 Living Standard</div>
    </div>
    <div class="metric-card">
      <div class="metric-value ${debtClass}">${debtStatus}</div>
      <div class="metric-label">Debt Trajectory</div>
    </div>
    <div class="metric-card">
      <div class="metric-value ${reformClass}">${reformWindow}</div>
      <div class="metric-label">Reform Window</div>
    </div>
    <div class="metric-card">
      <div class="metric-value ${depClass}">${workersPerRetiree}</div>
      <div class="metric-label">Workers per Retiree</div>
    </div>
  `;
}

function renderChart() {
  const ctx = document.getElementById('mainChart').getContext('2d');
  if (chart) chart.destroy();

  const labels = scenarioData.map(d => d.year);
  const baselineEnd = baselineData[baselineData.length - 1];
  const scenarioEnd = scenarioData[scenarioData.length - 1];

  // Determine scenario color based on outcome
  const isBetter = scenarioEnd.yPerCapita >= baselineEnd.yPerCapita;
  const scenarioColor = isBetter ? '#10B981' : '#EF4444';
  const scenarioBg = isBetter ? 'rgba(16, 185, 129, 0.15)' : 'rgba(239, 68, 68, 0.15)';

  chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [
        {
          label: 'Baseline',
          data: baselineData.map(d => d.yPerCapita),
          borderColor: '#6B7280',
          backgroundColor: 'rgba(107, 114, 128, 0.1)',
          borderWidth: 2,
          fill: true,
          tension: 0.3,
          pointRadius: 0,
        },
        {
          label: 'Your Scenario',
          data: scenarioData.map(d => d.yPerCapita),
          borderColor: scenarioColor,
          backgroundColor: scenarioBg,
          borderWidth: 3,
          fill: true,
          tension: 0.3,
          pointRadius: 0,
        },
      ],
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      interaction: { mode: 'index', intersect: false },
      plugins: {
        legend: {
          labels: { color: '#9CA3AF', font: { size: 12 } },
          position: 'top',
        },
        tooltip: {
          backgroundColor: '#1F2937',
          borderColor: '#374151',
          borderWidth: 1,
          callbacks: {
            label: function(context) {
              return context.dataset.label + ': ' + context.parsed.y.toFixed(2);
            }
          }
        },
      },
      scales: {
        x: {
          ticks: { color: '#9CA3AF', font: { size: 11 } },
          grid: { color: '#374151' },
        },
        y: {
          title: { display: true, text: 'Output per Capita', color: '#9CA3AF' },
          ticks: { color: '#9CA3AF', font: { size: 11 } },
          grid: { color: '#374151' },
        },
      },
    },
  });
}

function update() {
  scenarioData = runSimulation(params);
  renderMetrics();
  renderChart();
}

function init() {
  // Run baseline with defaults
  baselineData = runSimulation(DEFAULT_PARAMS);
  scenarioData = runSimulation(params);

  renderMetrics();
  renderChart();
}

init();
</script>
</body>
</html>
